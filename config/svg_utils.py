# svg_utils.py

import panel as pn

# Constants
HECTARES_PER_ICON = 31.19  # 1 Keukenhof park â‰ˆ 31.19 hectares

# Load your full SVG as a string (use any icon you like)
SVG_AREA_ICON = '''
    <?xml version="1.0" encoding="UTF-8"?><svg id="Layer_1" height="45px" width="45px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 64 64"><defs><style>.cls-1{stroke-linejoin:bevel;}.cls-1,.cls-2,.cls-3,.cls-4,.cls-5,.cls-6{fill:none;}.cls-1,.cls-3,.cls-4{stroke-width:.7px;}.cls-1,.cls-3,.cls-4,.cls-5,.cls-6{stroke:#e6e6e6;}.cls-1,.cls-4,.cls-5{stroke-linecap:round;}.cls-7{fill:#9bc45b;}.cls-3,.cls-8,.cls-4,.cls-6{stroke-miterlimit:10;}.cls-8{fill:#ccc;stroke:#ccc;}.cls-5{stroke-linejoin:round;}.cls-5,.cls-6{stroke-width:.4px;}.cls-9{fill:#b3b3b3;}.cls-10{clip-path:url(#clippath);}</style><clipPath id="clippath"><path class="cls-2" d="M26.52,4.49c2.42.46,4.79,1.44,7.25,1.25,2.49-.18,4.78-1.54,7.27-1.72,3.17-.24,6.61,1.39,9.39-.15,1.9-1.05,3.24-3.49,5.4-3.34,1.12.08,2.07.91,2.61,1.89s.73,2.11.9,3.22c2.76,17.36,3.68,34.95,4.6,52.5.05.98-.03,2.19-.91,2.61-.5.23-1.08.12-1.61,0-8.39-1.89-16.69-4.15-24.99-6.41-3.43-.94-6.86-1.87-10.3-2.81-1.56-.42-3.16-.87-4.46-1.83-2.55-1.89-3.35-5.28-4.07-8.37-.68-2.9-1.64-6.07-4.18-7.63-1.52-.93-3.43-1.16-4.79-2.3-1.3-1.09-1.86-2.8-2.31-4.43-.74-2.72-1.3-5.49-1.69-8.28-.19-1.4-.35-2.8-.45-4.21-.07-.97-.55-2.93-.14-3.83.68-1.48,4.61-2.59,6.06-3.24,2.49-1.1,5.06-2.07,7.73-2.65,2.85-.63,5.81-.81,8.68-.26Z"/></clipPath></defs><path class="cls-7" d="M26.52,4.49c2.42.46,4.79,1.44,7.25,1.25,2.49-.18,4.78-1.54,7.27-1.72,3.17-.24,6.61,1.39,9.39-.15,1.9-1.05,3.24-3.49,5.4-3.34,1.12.08,2.07.91,2.61,1.89s.73,2.11.9,3.22c2.76,17.36,3.68,34.95,4.6,52.5.05.98-.03,2.19-.91,2.61-.5.23-1.08.12-1.61,0-8.39-1.89-16.69-4.15-24.99-6.41-3.43-.94-6.86-1.87-10.3-2.81-1.56-.42-3.16-.87-4.46-1.83-2.55-1.89-3.35-5.28-4.07-8.37-.68-2.9-1.64-6.07-4.18-7.63-1.52-.93-3.43-1.16-4.79-2.3-1.3-1.09-1.86-2.8-2.31-4.43-.74-2.72-1.3-5.49-1.69-8.28-.19-1.4-.35-2.8-.45-4.21-.07-.97-.55-2.93-.14-3.83.68-1.48,4.61-2.59,6.06-3.24,2.49-1.1,5.06-2.07,7.73-2.65,2.85-.63,5.81-.81,8.68-.26Z"/><g class="cls-10"><path class="cls-8" d="M61.19,60.69c-3.27.07-6.45-1.04-9.49-2.24-.73-.29-1.46-.58-2.24-.7-.72-.11-1.45-.08-2.17-.16-1.02-.12-2.02-.48-2.82-1.11s-1.41-1.53-1.61-2.54c-.18-.9-.02-1.84-.16-2.75-.18-1.19-.87-2.29-1.87-2.96l4.23-1.21,2.65-1.09,2.62-1.45,2.44-.2-4.95,11.67.24.95,13.14,3.79Z"/><path class="cls-4" d="M34.71,28.24c3.5,9.05,5.02,9.96,5.97,19.7"/><path class="cls-9" d="M31.4,20.57l-.74.29,2.33,6.5.57.64s.88.62,2.36-.5,1.87-2.08,1.87-2.08c0,0,1.11-3.06,0-3.74s-2.05-1.32-3.32-1.37-3.08.26-3.08.26Z"/><path class="cls-5" d="M20.56,18.27c-.43-1.19.03-2.19.85-3.14s1.96-1.58,3.1-2.13c2.27-1.12,4.66-2.08,7.18-2.31,3.73-.34,7.4.96,10.87,2.38,1.83.75,3.67,1.56,5.13,2.89,1.97,1.79,3.06,4.33,3.86,6.87,1.59,5.07,2.2,10.44,1.86,15.74-.09,1.43-.27,2.92-1.08,4.1-.63.93-1.58,1.59-2.55,2.16-3.14,1.87-6.69,3.13-10.35,3.29-3.65.17-7.4-.81-10.32-3.01-4.03-3.04-6.11-8.04-7.1-12.99-1-4.95-.43-8.91-1.45-13.85"/><path class="cls-6" d="M27.07,15.76c1.85-.96,4.05-.99,6.13-.73,3.98.49,7.98,2.04,10.62,5.04,3.2,3.64,3.97,8.75,4.61,13.55.17,1.29.33,2.64-.12,3.86-.74,2.01-2.89,3.06-4.85,3.92-2.42,1.07-5.06,2.16-7.64,1.56-2.24-.52-4.01-2.24-5.43-4.05-3.97-5.07-6.75-12.35-6.25-18.88.14-1.81,1.32-3.44,2.92-4.27Z"/><path class="cls-4" d="M4.48,22.48c8.35-2.28,18.94-3.49,27.48-2.06.42.07.79-.29.72-.71-.4-2.23-1.04-4.41-1.33-6.65-.32-2.53-.14-5.25,1.24-7.4"/><path class="cls-4" d="M29.67,45.35c1.02-2.69,3.03-4.67,5.56-6.05s5.33-2.14,8.1-2.89c3.41-.92,6.49-1.85,9.9-2.77"/><path class="cls-4" d="M50.34,20.14c-1.33.33-2.18,1.58-2.99,2.68s-1.87,2.26-3.24,2.25c-1.27,0-2.27-1.01-3.25-1.8-2.32-1.87-6.03-2.91-9.01-2.84"/><path class="cls-4" d="M44.53,14.2c-.38,1.46-.93,3.13-2.34,3.69-.64.26-1.37.23-2.01.47-1.5.56-2.1,2.32-2.53,3.86-.32,1.17-.56,2.62.35,3.41.47.4,1.11.5,1.71.66,2.84.76,5.09,3.39,5.4,6.32.07.65.52,2.5.7,3.13"/><path class="cls-4" d="M13.9,34.05c.98-2.27,1.97-4.55,3.1-6.75.67-1.3,1.39-2.58,1.72-4,.84-3.6-.99-7.24-1.35-10.92-.23-2.35.53-8.33.91-10.66"/><path class="cls-4" d="M14.52,34.97c.91.92.93,2.53,1.98,3.28.67.48,1.57.46,2.37.27,2.8-.66,5.74-3.25,8.57-3.8"/><path class="cls-1" d="M52.55,25.9l5.15-18.43c.97-.67,2.27-1.01,3.44-1.13"/><path class="cls-3" d="M44.94,14.1c.88-3.08,1.88-6.19,3.65-8.86S53.02.34,56.17-.26"/></g></svg>
    '''
SVG_PIPE_ICON = """
<?xml version="1.0" encoding="UTF-8"?><svg id="Pipeline_1" height="45px" width="45px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 35 35"><defs><style>.cls-1{fill:#41537b;}.cls-2{fill:#a2aea7;}.cls-3{fill:#bdcbc3;}.cls-4{fill:#d9cdf1;}.cls-5{fill:#3b5b6e;}.cls-6{fill:#4c6fb0;}.cls-7{fill:#374766;}.cls-8{fill:#4d83b1;}.cls-9{fill:#2c535f;}.cls-10{fill:#3a6284;}.cls-11{fill:#3f6697;}.cls-12{fill:#3c6585;}</style></defs><path class="cls-12" d="M34.35,12.01c0-2.53-1.77-5.6-3.92-6.83-1.11-.64-2.12-.67-2.84-.21h0l-.68.44h.2c-.38.48-.61,1.18-.61,2.07,0,2.49,1.77,5.57,3.92,6.83.79.46,1.52.61,2.14.5l-.11.23.67-.43h0c.75-.4,1.22-1.3,1.22-2.61Z"/><path class="cls-5" d="M33.5,12.55c0-2.53-1.77-5.6-3.92-6.83-2.16-1.23-3.92-.2-3.92,2.3s1.77,5.57,3.92,6.83c2.16,1.26,3.92.23,3.92-2.3Z"/><path class="cls-9" d="M30.75,7.98c-.36-.4-.75-.73-1.17-.97-1.55-.88-2.81-.14-2.81,1.64,0,1.68,1.11,3.72,2.53,4.71.09.07.19.13.28.18,1.55.9,2.81.16,2.81-1.64,0-1.32-.68-2.85-1.64-3.93Z"/><path class="cls-12" d="M33.54,12.53c0-2.53-1.77-5.6-3.92-6.83-1.11-.64-2.12-.67-2.84-.21h0l-.68.44h.2c-.38.48-.61,1.18-.61,2.07,0,2.49,1.77,5.57,3.92,6.83.79.46,1.52.61,2.14.5l-.11.23.67-.43h0c.75-.4,1.22-1.3,1.22-2.61Z"/><path class="cls-5" d="M32.69,13.06c0-2.53-1.77-5.6-3.92-6.83-2.16-1.23-3.92-.2-3.92,2.3s1.77,5.57,3.92,6.83c2.16,1.26,3.92.23,3.92-2.3Z"/><path class="cls-9" d="M29.94,8.5c-.36-.4-.75-.73-1.17-.97-1.55-.88-2.81-.14-2.81,1.64,0,1.68,1.11,3.72,2.53,4.71.09.07.19.13.28.18,1.55.9,2.81.16,2.81-1.64,0-1.32-.68-2.85-1.64-3.93Z"/><path class="cls-12" d="M32.75,13.04c0-2.53-1.77-5.6-3.92-6.83-1.11-.64-2.12-.67-2.84-.21h0l-.68.44h.2c-.38.48-.61,1.18-.61,2.07,0,2.49,1.77,5.57,3.92,6.83.79.46,1.52.61,2.14.5l-.11.23.67-.43h0c.75-.4,1.22-1.3,1.22-2.61Z"/><path class="cls-5" d="M31.9,13.57c0-2.53-1.77-5.6-3.92-6.83-2.16-1.23-3.92-.2-3.92,2.3s1.77,5.57,3.92,6.83c2.16,1.26,3.92.23,3.92-2.3Z"/><path class="cls-9" d="M29.15,9c-.36-.4-.75-.73-1.17-.97-1.55-.88-2.81-.14-2.81,1.64,0,1.68,1.11,3.72,2.53,4.71.09.07.19.13.28.18,1.55.9,2.81.16,2.81-1.64,0-1.32-.68-2.85-1.64-3.93Z"/><path class="cls-11" d="M25.15,9.94l-.83-.89,1.49-.89c.06-.04.11-.08.17-.11h.01s0,0,0,0c.49-.26,1.15-.21,1.87.2,1.49.85,2.71,2.98,2.71,4.72,0,.76-.23,1.32-.61,1.65h0s0,0,0,0c-.1.08-.21.15-.32.2l-1.5.92-.8-1.55c-1.21-.99-2.14-2.75-2.18-4.25Z"/><path class="cls-10" d="M28.92,13.96c0-1.75-1.22-3.87-2.71-4.72-1.49-.85-2.71-.14-2.71,1.59s1.22,3.85,2.71,4.72c1.49.87,2.71.16,2.71-1.59Z"/><path class="cls-2" d="M28.06,13.47c0-1.19-.83-2.64-1.85-3.22-1.02-.58-1.85-.09-1.85,1.08s.83,2.63,1.85,3.22c1.02.6,1.85.11,1.85-1.08Z"/><path class="cls-4" d="M26.25,14.1c0-.91-.63-2.01-1.41-2.45-.77-.44-1.41-.07-1.41.82s.63,2,1.41,2.45c.77.45,1.41.08,1.41-.82Z"/><path class="cls-4" d="M25.12,14.8c0-.91-.63-2.01-1.41-2.45-.77-.44-1.41-.07-1.41.82s.63,2,1.41,2.45c.77.45,1.41.08,1.41-.82Z"/><path class="cls-4" d="M24.12,15.43c0-.91-.63-2.01-1.41-2.45-.77-.44-1.41-.07-1.41.82s.63,2,1.41,2.45c.77.45,1.41.08,1.41-.82Z"/><path class="cls-1" d="M23.65,16.51c0-1.33-.93-2.94-2.06-3.59-1.13-.65-2.06-.1-2.06,1.21s.93,2.93,2.06,3.59c1.13.66,2.06.12,2.06-1.21Z"/><path class="cls-7" d="M22.99,16.13c0-.91-.63-2.01-1.41-2.45-.77-.44-1.41-.07-1.41.82s.63,2,1.41,2.45c.77.45,1.41.08,1.41-.82Z"/><path class="cls-4" d="M22.1,16.66c0-.91-.63-2.01-1.41-2.45-.77-.44-1.41-.07-1.41.82s.63,2,1.41,2.45c.77.45,1.41.08,1.41-.82Z"/><path class="cls-4" d="M20.97,17.36c0-.91-.63-2.01-1.41-2.45-.77-.44-1.41-.07-1.41.82s.63,2,1.41,2.45c.77.45,1.41.08,1.41-.82Z"/><path class="cls-4" d="M19.97,18c0-.91-.63-2.01-1.41-2.45-.77-.44-1.41-.07-1.41.82s.63,2,1.41,2.45c.77.45,1.41.08,1.41-.82Z"/><path class="cls-1" d="M19.5,19.07c0-1.33-.93-2.94-2.06-3.59-1.13-.65-2.06-.1-2.06,1.21s.93,2.93,2.06,3.59c1.13.66,2.06.12,2.06-1.21Z"/><path class="cls-7" d="M18.84,18.7c0-.91-.63-2.01-1.41-2.45-.77-.44-1.41-.07-1.41.82s.63,2,1.41,2.45c.77.45,1.41.08,1.41-.82Z"/><path class="cls-4" d="M18.02,19.2c0-.91-.63-2.01-1.41-2.45-.77-.44-1.41-.07-1.41.82s.63,2,1.41,2.45c.77.45,1.41.08,1.41-.82Z"/><path class="cls-4" d="M16.89,19.9c0-.91-.63-2.01-1.41-2.45-.77-.44-1.41-.07-1.41.82s.63,2,1.41,2.45c.77.45,1.41.08,1.41-.82Z"/><path class="cls-4" d="M15.9,20.53c0-.91-.63-2.01-1.41-2.45-.77-.44-1.41-.07-1.41.82s.63,2,1.41,2.45c.77.45,1.41.08,1.41-.82Z"/><path class="cls-1" d="M15.42,21.61c0-1.33-.93-2.94-2.06-3.59-1.13-.65-2.06-.1-2.06,1.21s.93,2.93,2.06,3.59c1.13.66,2.06.12,2.06-1.21Z"/><path class="cls-7" d="M14.77,21.23c0-.91-.63-2.01-1.41-2.45-.77-.44-1.41-.07-1.41.82s.63,2,1.41,2.45c.77.45,1.41.08,1.41-.82Z"/><path class="cls-4" d="M13.87,21.76c0-.91-.63-2.01-1.41-2.45-.77-.44-1.41-.07-1.41.82s.63,2,1.41,2.45c.77.45,1.41.08,1.41-.82Z"/><path class="cls-4" d="M12.74,22.46c0-.91-.63-2.01-1.41-2.45-.77-.44-1.41-.07-1.41.82s.63,2,1.41,2.45c.77.45,1.41.08,1.41-.82Z"/><path class="cls-4" d="M11.75,23.1c0-.91-.63-2.01-1.41-2.45-.77-.44-1.41-.07-1.41.82s.63,2,1.41,2.45c.77.45,1.41.08,1.41-.82Z"/><path class="cls-6" d="M28.16,13.72c0-1.33-.93-2.94-2.06-3.59-.16-.09-.31-.15-.45-.2h0c-.56-.22-1.04.05-1.04.05l-13.3,8.27-.27.16h0s-.09.05-.13.08l-.52.32-.49.29h0c-.06.03-.11.07-.16.11l-1.97,1.22.51.54s0,.07,0,.11c0,1.25.85,2.79,1.92,3.5l.48.93,1.14-.7c.09-.04.17-.09.25-.15h0s0,0,0,0c0,0,0,0,.01,0l.87-.54c.09-.04.17-.09.25-.15h0s0,0,0,0c0,0,0,0,0,0l2.8-1.72c.07-.03.13-.07.19-.12l.95-.58c.06-.03.12-.07.18-.11l10.25-6.31s.31-.19.4-.47h0c.13-.24.21-.55.21-.93Z"/><path class="cls-3" d="M11.27,24.17c0-1.33-.93-2.94-2.06-3.59-1.13-.65-2.06-.1-2.06,1.21s.93,2.93,2.06,3.59c1.13.66,2.06.12,2.06-1.21Z"/><path class="cls-2" d="M10.61,23.79c0-.91-.63-2.01-1.41-2.45-.77-.44-1.41-.07-1.41.82s.63,2,1.41,2.45c.77.45,1.41.08,1.41-.82Z"/><path class="cls-11" d="M5.95,20.81l-1-1.07,1.79-1.07c.07-.05.14-.1.21-.14h.01s0,0,0,0c.59-.31,1.38-.26,2.24.24,1.79,1.02,3.26,3.58,3.26,5.68,0,.91-.28,1.59-.74,1.98h0s0,0,0,0c-.12.1-.25.18-.39.24l-1.8,1.11-.96-1.86c-1.46-1.19-2.57-3.31-2.62-5.1Z"/><path class="cls-8" d="M10.48,25.65c0-2.1-1.47-4.65-3.26-5.68-1.79-1.02-3.26-.17-3.26,1.91s1.47,4.63,3.26,5.68c1.79,1.05,3.26.19,3.26-1.91Z"/><path class="cls-12" d="M10.95,25.94c0-2.53-1.77-5.6-3.92-6.83-1.11-.64-2.12-.67-2.84-.21h0l-.68.44h.2c-.38.48-.61,1.18-.61,2.07,0,2.49,1.77,5.57,3.92,6.83.79.46,1.52.61,2.14.5l-.11.23.67-.43h0c.75-.4,1.22-1.3,1.22-2.61Z"/><path class="cls-5" d="M10.1,26.48c0-2.53-1.77-5.6-3.92-6.83-2.16-1.23-3.92-.2-3.92,2.3s1.77,5.57,3.92,6.83c2.16,1.26,3.92.23,3.92-2.3Z"/><path class="cls-9" d="M7.35,21.91c-.36-.4-.75-.73-1.17-.97-1.55-.88-2.81-.14-2.81,1.64,0,1.68,1.11,3.72,2.53,4.71.09.07.19.13.28.18,1.55.9,2.81.16,2.81-1.64,0-1.32-.68-2.85-1.64-3.93Z"/><path class="cls-12" d="M10.14,26.46c0-2.53-1.77-5.6-3.92-6.83-1.11-.64-2.12-.67-2.84-.21h0l-.68.44h.2c-.38.48-.61,1.18-.61,2.07,0,2.49,1.77,5.57,3.92,6.83.79.46,1.52.61,2.14.5l-.11.23.67-.43h0c.75-.4,1.22-1.3,1.22-2.61Z"/><path class="cls-5" d="M9.29,26.99c0-2.53-1.77-5.6-3.92-6.83-2.16-1.23-3.92-.2-3.92,2.3s1.77,5.57,3.92,6.83c2.16,1.26,3.92.23,3.92-2.3Z"/><path class="cls-9" d="M6.54,22.42c-.36-.4-.75-.73-1.17-.97-1.55-.88-2.81-.14-2.81,1.64,0,1.68,1.11,3.72,2.53,4.71.09.07.19.13.28.18,1.55.9,2.81.16,2.81-1.64,0-1.32-.68-2.85-1.64-3.93Z"/><path class="cls-12" d="M9.35,26.97c0-2.53-1.77-5.6-3.92-6.83-1.11-.64-2.12-.67-2.84-.21h0l-.68.44h.2c-.38.48-.61,1.18-.61,2.07,0,2.49,1.77,5.57,3.92,6.83.79.46,1.52.61,2.14.5l-.11.23.67-.43h0c.75-.4,1.22-1.3,1.22-2.61Z"/><path class="cls-5" d="M8.5,27.5c0-2.53-1.77-5.6-3.92-6.83-2.16-1.23-3.92-.2-3.92,2.3s1.77,5.57,3.92,6.83c2.16,1.26,3.92.23,3.92-2.3Z"/><path class="cls-9" d="M5.75,22.93c-.36-.4-.75-.73-1.17-.97-1.55-.88-2.81-.14-2.81,1.64,0,1.68,1.11,3.72,2.53,4.71.09.07.19.13.28.18,1.55.9,2.81.16,2.81-1.64,0-1.32-.68-2.85-1.64-3.93Z"/></svg>
"""

# ------------------------------------------------------------------------------
# Area SVG Generator (e.g. for nature damage)
# ------------------------------------------------------------------------------

def generate_area_SVG(area_ha):
    """
    Generates a visual representation of area using repeated SVGs.

    Args:
        area_ha (float): The area in hectares.

    Returns:
        panel.Column: Panel layout with the SVG icons.
    """
    full_units = int(area_ha // HECTARES_PER_ICON)
    partial_ratio = (area_ha % HECTARES_PER_ICON) / HECTARES_PER_ICON

    full_icons = SVG_AREA_ICON * full_units

    # Optionally scale partial icon with opacity
    if partial_ratio > 0:
        partial_icon = SVG_AREA_ICON.replace('fill="#29abe2"', f'fill-opacity="{partial_ratio:.2f}" fill="#29abe2"')
    else:
        partial_icon = ""

    combined = full_icons + partial_icon
    return pn.pane.HTML(combined, width=400, height=50 + 35 * (full_units + (1 if partial_icon else 0)))


# ------------------------------------------------------------------------------
# Pipe Connection SVG Generator
# ------------------------------------------------------------------------------

def generate_pipes_SVG(origin: str, destination: str, count: int):
    """
    Generate a horizontal row of pipe icons between two locations.

    Args:
        origin (str): Name of the origin balance area.
        destination (str): Name of the destination balance area.
        count (int): Number of connections (pipes).

    Returns:
        panel.Row: A Panel layout with description and SVG icons.
    """
    fig =pn.pane.HTML(SVG_PIPE_ICON*count)
    OD = pn.pane.HTML(f'<p style="color:#3850A0; font-size:14px; margin:4px;">Leidingen van \n<b>{origin} naar {destination}</b>:  ')
    pane = pn.Row(OD, fig)
    return pane
